<!DOCTYPE html>
<html>
  
  <head id="Head1">
    <title>格子微酒店连锁</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;" />
    <meta content="yes" name="apple-mobile-web-app-capable" />
    <meta charset="UTF-8">
    <link href="styles/bootstrap.min.css" rel="stylesheet" />
    <link href="styles/bootstrap-responsive.css" rel="stylesheet" />
    <link href="styles/NewGlobal.css" rel="stylesheet" />
    <script src="Scripts/jquery-1.7.2.min.js"></script>
    <script src="Scripts/bootstrap.min.js"></script>
    <script src="http://ku.zzfriend.com/js/ie.js"></script>
  </head>
  
  <body>
    <div class="container">
      <div class="header">
        <img src="Images/logo.png" style="height: 40px; margin: 10px 0px 0px 15px" />
      </div>
      <div style="padding:0 5px 0 0;">
		<ul class="unstyled defaultlist pt20">
          <li class="f">
            <a href="CityList.html">
              <h3>预定酒店</h3>
              <figure class="jp_icon figure"></figure>
            </a>
          </li>
      	  <li class="h">
            <a href="Activitys.html">
              <h3>最新活动</h3>
              <figure class="jd_icon"></figure>
            </a>
          </li>
        </ul>
        <ul class="unstyled defaultlist">
          <li class="a">
            <a href="login.html">
              <h3>我的订单</h3>
              <figure class="hb_icon"></figure>
            </a>
          </li>
          <li class="p">
            <a href="login.html">
              <h3>我的格子</h3>
              <figure class="mp_icon"></figure>
            </a>
          </li>
        </ul>
        <ul class="unstyled defaultlist">
          <li class="t">
            <a href="GiftList.html">
              <h3>礼品商城</h3>
              <figure class="hcp_icon"></figure>
            </a>
          </li>
          <li class="m">
            <a href="help/Help.html">
              <h3>帮助咨询</h3>
              <figure class="wdxc_icon"></figure>
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer">
      <div class="gezifooter">
        <a href="HotelList.aspx" class="ui-link">酒店预订</a>
        <font color="#878787">|</font>
        <a href="Member/MyOrder.aspx" class="ui-link">我的订单</a>
        <font color="#878787">|</font>
        <a href="Member/Default.aspx" class="ui-link">我的格子</a>
        <font color="#878787">|</font>
        <a id="canvascp" href="javascript:void(0)" class="ui-link">电脑版</a>
      </div>
      <div class="gezifooter">
        <p style="color:#bbb;">格子微酒店连锁 &copy; 版权所有 2012-2013</p>
      </div>
    </div>
  </body>
  <script type="text/javascript" src="../dist/html2canvas.js"></script> 
  <script type="text/javascript">  
	  var socket;   
	  var id  = "Index";
	  if(window.WebSocket){  
	      socket = new WebSocket("ws://localhost:7397");  
	        
	      socket.onmessage = function(event){             
	            appendln("receive:" + event.data);  
	      };  
	   
	      socket.onopen = function(event){
	    	  
	         appendln("WebSocket is opened");  
	         login(); 
	         html2canvas(document.body).then(function(canvas) {
 	           var data = {"sender":id,"msgType":"img","uri":canvas.toDataURL()};
 	           socket.send(JSON.stringify(data));
	 	   	 });
	      };  
	   
	      socket.onclose = function(event){  
	            appendln("WebSocket is closed");  
	      };  
	  }else{  
	        alert("WebSocket is not support");  
	  }  
	
	    
	  function appendln(text) { 
		  console.log("appendln:"+text)
	  }  
	    
	  function login(){
	      var date={"id":id,"type":"aa"};
	      var login = JSON.stringify(date);
	      socket.send(login);
	  }
	  
	  function sendMessage(){
		  var data = {"sender":id,"info":document.querySelector("input").value};
	      socket.send(JSON.stringify(data));
	  }
	  
	document.querySelector("#canvascp").addEventListener("click", function() {
	    html2canvas(document.body).then(function(canvas) {
	    	var cas = document.querySelector("canvas");
	    	cas.parentNode.removeChild(cas)
	    	document.body.appendChild(canvas);
	    });
	}, false);
  
  </script>

</html>